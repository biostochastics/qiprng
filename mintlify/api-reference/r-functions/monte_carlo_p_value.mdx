---
title: 'monte_carlo_p_value'
description: 'Monte Carlo p-value calculation'
sidebarTitle: 'monte_carlo_p_value'
---

# Monte Carlo p-value calculation


 Estimates p-values by simulating the null distribution of a test statistic
 using Monte Carlo methods. This is useful when the null distribution can
 be simulated but not analytically derived.


## Usage

```r

 monte_carlo_p_value(
   observed_stat,
   null_simulator,
   test_statistic,
   n_simulations = 10000,
   alternative = "two.sided",
   progress = TRUE,
   seed = NULL,
   ...
 )

```

## Parameters

<ParamField body="observed_stat" type="any">
  The observed test statistic
</ParamField>
<ParamField body="null_simulator" type="any">
  Function that generates data under null hypothesis
</ParamField>
<ParamField body="test_statistic" type="any">
  Function that computes test statistic from simulated data
</ParamField>
<ParamField body="n_simulations" type="any">
  Number of Monte Carlo simulations (default: 10000)
</ParamField>
<ParamField body="alternative" type="any">
  Character string specifying the alternative hypothesis
</ParamField>
<ParamField body="progress" type="any">
  Logical; show progress bar (default: TRUE)
</ParamField>
<ParamField body="seed" type="any">
  Random seed for reproducibility (default: NULL)
</ParamField>
<ParamField body="..." type="any">
  Additional arguments passed to null_simulator
</ParamField>

## Returns


 A list containing:
 p.value The Monte Carlo p-value
 simulated_stats Vector of simulated test statistics
 observed_stat The observed test statistic
 n_simulations Number of simulations used


## Examples

```r


 # Test for correlation
 observed_cor <- cor(x, y)
 null_sim <- function(n) {
   list(x = rnorm(n), y = rnorm(n))
 }
 stat_func <- function(data) cor(data$x, data$y)
 result <- monte_carlo_p_value(observed_cor, null_sim, stat_func, n = 100)


```
